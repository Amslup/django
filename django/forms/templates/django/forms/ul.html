{% if errors %}
  <li>
    {{ errors }}
  {% if not fields %}
    {% for field in hidden_fields %}{{ field }}{% endfor %}
  {% endif %}
  </li>
{% endif %}
{% for field in fields %}
  {{ field.as_ul }}
  {% if forloop.last %}
    <li hidden>{% for field in hidden_fields %}{{ field }}{% endfor %}</li>
  {% endif %}
{% endfor %}
{% if not fields and not errors %}
  {% for field in hidden_fields %}{{ field }}{% endfor %}
{% endif %}
