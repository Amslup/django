(function(b){b.fn.formset=function(d){var a=b.extend({},b.fn.formset.defaults,d),f=b(this);d=f.parent();var l=function(a,e,m){var c=new RegExp("("+e+"-(\\d+|__prefix__))");e=e+"-"+m;b(a).prop("for")&&b(a).prop("for",b(a).prop("for").replace(c,e));a.id&&(a.id=a.id.replace(c,e));a.name&&(a.name=a.name.replace(c,e))},k=b("#id_"+a.prefix+"-TOTAL_FORMS").prop("autocomplete","off"),m=parseInt(k.val(),10),e=b("#id_"+a.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),c,n=""===e.val()||0<e.val()-k.val();
f.each(function(e){b(this).not("."+a.emptyCssClass).addClass(a.formCssClass)});f.length&&n&&("TR"===f.prop("tagName")?(f=this.eq(-1).children().length,d.append('<tr class="'+a.addCssClass+'"><td colspan="'+f+'"><a href="javascript:void(0)">'+a.addText+"</a></tr>"),c=d.find("tr:last a")):(f.filter(":last").after('<div class="'+a.addCssClass+'"><a href="javascript:void(0)">'+a.addText+"</a></div>"),c=f.filter(":last").next().find("a")),c.click(function(g){g.preventDefault();g=b("#"+a.prefix+"-empty");
var h=g.clone(!0);h.removeClass(a.emptyCssClass).addClass(a.formCssClass).attr("id",a.prefix+"-"+m);h.find("*").each(function(){l(this,a.prefix,k.val())});h.insertBefore(b(g));b(k).val(parseInt(k.val(),10)+1);m+=1;""!==e.val()&&0>=e.val()-k.val()&&c.parent().hide();a.added&&a.added(h);b(document).trigger("formset:added",[h,a.prefix])}));b(this).each(function(){b(this).find("[name="+b(this).attr("id")+"-id]").val()||(b(this).is("tr")?b(this).children(":last").append('<div><a class="'+a.deleteCssClass+
'" href="javascript:void(0)">'+a.deleteText+"</a></div>"):b(this).is("ul")||b(this).is("ol")?b(this).append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):b(this).children(":first").append('<span><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></span>"),b(this).find("a."+a.deleteCssClass).click(function(g){g.preventDefault();g=b(this).parents("."+a.formCssClass);g.remove();--m;a.removed&&a.removed(g);b(document).trigger("formset:removed",
[g,a.prefix]);g=b("."+a.formCssClass);b("#id_"+a.prefix+"-TOTAL_FORMS").val(g.length);(""===e.val()||0<e.val()-g.length)&&c.parent().show();var h,d,f=function(){l(this,a.prefix,h)};h=0;for(d=g.length;h<d;h++)l(b(g).get(h),a.prefix,h),b(g.get(h)).find("*").each(f)}))});return this};b.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null};b.fn.tabularFormset=
function(d){var a=b(this),f=function(m){b(a.selector).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")},l=function(){"undefined"!==typeof SelectFilter&&(b(".selectfilter").each(function(b,a){var c=a.name.split("-");SelectFilter.init(a.id,c[c.length-1],!1)}),b(".selectfilterstacked").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!0)}))},k=function(a){a.find(".prepopulated_field").each(function(){var e=
b(this).find("input, select, textarea"),c=e.data("dependency_list")||[],d=[];b.each(c,function(b,e){d.push("#"+a.find(".field-"+e).find("input, select, textarea").attr("id"))});d.length&&e.prepopulate(d,e.attr("maxlength"))})};a.formset({prefix:d.prefix,addText:d.addText,formCssClass:"dynamic-"+d.prefix,deleteCssClass:"inline-deletelink",deleteText:d.deleteText,emptyCssClass:"empty-form",removed:f,added:function(a){k(a);"undefined"!==typeof DateTimeShortcuts&&(b(".datetimeshortcuts").remove(),DateTimeShortcuts.init());
l();f(a)}});return a};b.fn.stackedFormset=function(d){var a=b(this),f=function(d){b(a.selector).find(".inline_label").each(function(a){a+=1;b(this).html(b(this).html().replace(/(#\d+)/g,"#"+a))})},l=function(){"undefined"!==typeof SelectFilter&&(b(".selectfilter").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!1)}),b(".selectfilterstacked").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!0)}))},k=function(a){a.find(".prepopulated_field").each(function(){var e=
b(this).find("input, select, textarea"),c=e.data("dependency_list")||[],d=[];b.each(c,function(b,c){d.push("#"+a.find(".form-row .field-"+c).find("input, select, textarea").attr("id"))});d.length&&e.prepopulate(d,e.attr("maxlength"))})};a.formset({prefix:d.prefix,addText:d.addText,formCssClass:"dynamic-"+d.prefix,deleteCssClass:"inline-deletelink",deleteText:d.deleteText,emptyCssClass:"empty-form",removed:f,added:function(a){k(a);"undefined"!==typeof DateTimeShortcuts&&(b(".datetimeshortcuts").remove(),
DateTimeShortcuts.init());l();f(a)}});return a}})(django.jQuery);
