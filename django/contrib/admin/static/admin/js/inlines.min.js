(function(a){a.fn.formset=function(f){var b=a.extend({},a.fn.formset.defaults,f),k=function(c,d,g){var h=RegExp("("+d+"-(\\d+|__prefix__))");d=d+"-"+g;a(c).attr("for")&&a(c).attr("for",a(c).attr("for").replace(h,d));if(c.id)c.id=c.id.replace(h,d);if(c.name)c.name=c.name.replace(h,d)};f=a("#id_"+b.prefix+"-TOTAL_FORMS").attr("autocomplete","off");var l=parseInt(f.val(),10),i=a("#id_"+b.prefix+"-MAX_NUM_FORMS").attr("autocomplete","off");f=i.val()===""||i.val()-f.val()>0;a(this).each(function(){a(this).not("."+
b.emptyCssClass).addClass(b.formCssClass)});if(a(this).length&&f){var e;if(a(this).attr("tagName")=="TR"){f=this.eq(-1).children().length;a(this).parent().append('<tr class="'+b.addCssClass+'"><td colspan="'+f+'"><a href="javascript:void(0)">'+b.addText+"</a></tr>");e=a(this).parent().find("tr:last a")}else{a(this).filter(":last").after('<div class="'+b.addCssClass+'"><a href="javascript:void(0)">'+b.addText+"</a></div>");e=a(this).filter(":last").next().find("a")}e.click(function(c){c.preventDefault();
var d=a("#id_"+b.prefix+"-TOTAL_FORMS");c=a("#"+b.prefix+"-empty");var g=c.clone(true);g.removeClass(b.emptyCssClass).addClass(b.formCssClass).attr("id",b.prefix+"-"+l);if(g.is("tr"))g.children(":last").append('<div><a class="'+b.deleteCssClass+'" href="javascript:void(0)">'+b.deleteText+"</a></div>");else g.is("ul")||g.is("ol")?g.append('<li><a class="'+b.deleteCssClass+'" href="javascript:void(0)">'+b.deleteText+"</a></li>"):g.children(":first").append('<span><a class="'+b.deleteCssClass+'" href="javascript:void(0)">'+
b.deleteText+"</a></span>");g.find("*").each(function(){k(this,b.prefix,d.val())});g.insertBefore(a(c));a(d).val(parseInt(d.val(),10)+1);l+=1;i.val()!==""&&i.val()-d.val()<=0&&e.parent().hide();g.find("a."+b.deleteCssClass).click(function(h){h.preventDefault();h=a(this).parents("."+b.formCssClass);h.remove();l-=1;b.removed&&b.removed(h);h=a("."+b.formCssClass);a("#id_"+b.prefix+"-TOTAL_FORMS").val(h.length);if(i.val()===""||i.val()-h.length>0)e.parent().show();for(var j=0,m=h.length;j<m;j++){k(a(h).get(j),
b.prefix,j);a(h.get(j)).find("*").each(function(){k(this,b.prefix,j)})}});b.added&&b.added(g)})}return this};a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null};a.fn.tabularFormset=function(f){var b=this,k=function(){a(b).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")},l=function(){if(typeof SelectFilter!=
"undefined"){a(".selectfilter").each(function(e,c){var d=c.name.split("-");SelectFilter.init(c.id,d[d.length-1],false,f.adminStaticPrefix)});a(".selectfilterstacked").each(function(e,c){var d=c.name.split("-");SelectFilter.init(c.id,d[d.length-1],true,f.adminStaticPrefix)})}},i=function(e){e.find(".prepopulated_field").each(function(){var c=a(this).find("input, select, textarea"),d=c.data("dependency_list")||[],g=[];a.each(d,function(h,j){g.push("#"+e.find(j).find("input, select, textarea").attr("id"))});
g.length&&c.prepopulate(g,c.attr("maxlength"))})};a(b).formset({prefix:f.prefix,addText:f.addText,formCssClass:"dynamic-"+f.prefix,deleteCssClass:"inline-deletelink",deleteText:f.deleteText,emptyCssClass:"empty-form",removed:k,added:function(e){i(e);if(typeof DateTimeShortcuts!="undefined"){a(".datetimeshortcuts").remove();DateTimeShortcuts.init()}l();k(e)}})};a.fn.stackedFormset=function(f){var b=this,k=function(){a(b).find(".inline_label").each(function(e){e=e+1;a(this).html(a(this).html().replace(/(#\d+)/g,
"#"+e))})},l=function(){if(typeof SelectFilter!="undefined"){a(".selectfilter").each(function(e,c){var d=c.name.split("-");SelectFilter.init(c.id,d[d.length-1],false,f.adminStaticPrefix)});a(".selectfilterstacked").each(function(e,c){var d=c.name.split("-");SelectFilter.init(c.id,d[d.length-1],true,f.adminStaticPrefix)})}},i=function(e){e.find(".prepopulated_field").each(function(){var c=a(this).find("input, select, textarea"),d=c.data("dependency_list")||[],g=[];a.each(d,function(h,j){g.push("#"+
e.find(".form-row .field-"+j).find("input, select, textarea").attr("id"))});g.length&&c.prepopulate(g,c.attr("maxlength"))})};a(b).formset({prefix:f.prefix,addText:f.addText,formCssClass:"dynamic-"+f.prefix,deleteCssClass:"inline-deletelink",deleteText:f.deleteText,emptyCssClass:"empty-form",removed:k,added:function(e){i(e);if(typeof DateTimeShortcuts!="undefined"){a(".datetimeshortcuts").remove();DateTimeShortcuts.init()}l();k(e)}})}})(django.jQuery);
